---
layout: post
title:  "Job Interview_OS part1"
date: 2021-12-07 06:00:00
category: OS
use_math: true
tags: OS
---


# Job Interview

## Operating system

### 1. 프로세스와 스레드의 차이(Process vs Thread)

#### 프로세스

프로세스는 컴퓨터에서 실행되고 있는 프로그램을 말합니다. 프로그래밍 언어로 제작되어 정적인 상태로 HDD 또는 SSD에 저장된 프로그램을 실행하면 운영체제로부터 주소공간, 파일, 메모리 등을 할당받으며 이것들을 총칭하여 프로세스라고 합니다.

프로세스는 실행할 프로그램의 코드를 읽어오는 **코드 영역**, 전역 변수들을 수록하는 **데이터 영역**, 함수의 매개변수, 로컬 변수와 복귀주소와 같은 임시 자료를 저장하는 **stack 영역**,    프로세스 실행중에 동적으로 할당되는 메모리인 **heap 영역**을 가지고 있습니다.  

#### 프로세스 제어 블록(Process Control Block, PCB)

PCB는 특정 프로세스에 대한 중요한 정보를 저장하고 있는 운영체제의 자료구조입니다. 운영체제는 프로세스를 관리하기 위해 프로세스의 생성과 동시에 고유한 PCB를 생성합니다. 멀티 프로세싱을 하는 경우, CPU에서 작업하던 프로세스가 진행하던 작업을 저장하고 CPU를 반환하는 프로세스 전환이 발생하는데, 이 때 작업의 진행상황을 모두 PCB에 저장하게 됩니다. 그리고 다시 CPU를 할당받아 작업을 하게되면 PCB에 저장되어있던 내용을 불러와 이전에 종료되었던 시점부터 다시 작업을 수행합니다.

PCB에 저장되는 정보는 다음과 같습니다.

- 프로세스 식별자(Process ID, PID): 프로세스 식별번호
- 프로세스 상태: new or Create, ready, running, waiting, terminated 등의 상태를 저장
- 프로그램 카운터(PC) : 프로세스가 다음에 실행할 명령어의 주소
- CPU 레지스터
- CPU 스케줄링 정보: 프로세스의 우선순위, 스케줄 큐에 대한 포인터 등
- 메모리 관리 정보: 페이지 테이블 또는 세그먼트 테이블 등과 같은 정보를 포함
- 입출력 상태 정보: 프로세스에 할당된 입출력 장치들과 열린 파일목록
- accounting 정보: 사용된 CPU 시간, 시간제한, 계정번호 등

#### 스레드(Thread)

스레드는 한 프로세스 내에서 실행되는 여러 실행 흐름의 단위라고 할 수 있습니다. 하나의 프로세스를 다수의 실행 단위로 구분하여 자원을 공유하고 자원의 생성과 관리의 중복성을 최소화하여 수행 능력을 향상시키는 것을 멀티스레딩이라 합니다. 한 프로세스 안에서 코드 영역, 데이터 영역, 힙영역을 공유하고 있지만 스레드 ID, 프로그램 카운터, 레지스터 집합 그리고 스택 영역은 별도로 할당받습니다. 

**스택을 독립적으로 할당하는 이유**
스택 메모리 공간을 독립적으로 할당하여, 각 스레드마다 독립적인 함수호출을 가능하게 하여, 실행 흐름의 독립성을 유지할 수 있게 합니다.

**PC 레지스터를 스레드마다 독립적으로 할당하는 이유**
PC 레지스터는 스레드가 다음에 실행할 명령어의 주소를 저장하며, 스레드도 CPU를 할당받고, 스케줄러에 의해 다시 선점당하기 때문에 각 스레드마다 PC 레지스터는 독립적으로 할당되어야 합니다.


### 2. 멀티 프로세스 대신 멀티 스레드를 사용하는 이유

#### 멀티 스레드의 장점

프로세스를 이용하여 동시에 처리하는 일을 스레드로 구현할 경우, 메모리 공간과 시스템 자원 소모가 줄어들게 됩니다. 스레드 간의 통신이 필요한 경우에도 별도의 자원을 이용하지 않고 전역 변수의 공간인 데이터 영역 또는 동적으로 할당된 공간인 heap 영역을 이용하여 데이터를 주고 받을 수 있어 프로세스 간 통신방법에 비해 훨씬 간단합니다. 또한 스레드의 context switch는 프로세스의 context switch와는 달리 캐시 메모리를 비울 필요가 없어 더 빠릅니다. 따라서 시스템의 throughput이 향상되고 자원 소모가 줄어둘어 프로그램의 응답 시간이 단축됩니다. 이러한 장점들이 있기에 여러 프로세스로 할 수 있는 작업들을 하나의 프로세스에서 스레드로 나눠 수행하는 것입니다.

#### 멀티 스레드의 단점

멀티 스레딩을 구현하는 경우, 서로 다른 스레드가 데이터와 힙 영역을 공유하기 때문에 어떤 스레드가 다른 스레드에서 사용중인 변수나 자료구조에 접근하여 엉뚱한 값을 읽어오거나 수정할 수 있습니다. 그렇기에 동기화 작업을 통헤 작업 처리 순서, 공유 자원에 대한 접근을 관리해야 합니다. 하지만 이로 인해 병목현상이 발생하여 성능이 저하될 가능성이 높습니다. 따라서 threadpool을 제한하여 과한 멀티스레딩 작업은 피해야 합니다.

#### 멀티 스레드 vs 멀티 프로세스

멀티 스레드는 멀티 프로세스보다 적은 메모리 공간을 차지하고 context switching이 빠르다는 장점이 있지만, 오류로 인해 하나의 스레드가 종료되면 전체 스레드가 종료될 수 있다는 점과 동기화 작업의 필요를 단점으로 가지고 있습니다. 반면 멀티 프로세스 방식은 하나의 프로세스가 죽더라도 다른 프로세스에는 영향을 끼치지 않고 정상적으로 수행된다는 장점이 있지만, 멀티 스레드보다 많은 메모리 공간과 CPU시간을 차지한다는 단점을 가지고 있습니다. 
이 두가지 방법 모두 여러 작업의 병렬처리를 가능케하지만, 각자의 장단점을 가지고 있습니다. 적용해야 하는 시스템에 따라 적합한 동작 방식을 선택하여 적용해야 합니다.


### Context Switching이 무엇인지 설명하고 과정을 나열해주세요

context switching은 CPU를 할당받아 작업중인 프로세스로부터 다른 프로세스로 CPU의 제어권을 이양되는 과정을 말합니다. 작업중인 process1이 실행되다 interrupt가 발생하면, process1을 대기 상태또는 중지상태로 전환합니다. precess 1의 상태를 process1의 PCB에 저장하고, 다음으로 실행할 프로세스로 process2를 선택합니다. precess 2의 PCB에서 process2의 정보를 불러와 프로세서에 저장하여 process2를 실행합니다. 

우선순위가 높은 프로세스를 먼저 처리할 수 있어 효율이 좋지만 Context switching이 빈번하게 일어나면
비효율이 발생합니다. 


### 3. 사용자 수준 스레드와 커널 수준 스레드의 차이 설명

#### 사용자 수준 스레드

사용자 수준 스레드는 사용자 영역의 스레드 라이브러리로 구현하고, 스레드와 관련된 모든 행위를 사용자영역에서 하므로 커널이 스레드의 존재를 알지 못합니다.  여기서 스레드 라이브러리는 스레드의 생성과 종료, 스레드 간의 통신, 스레드의 스케줄링과 context 등 정보를 보관합니다. 사용자 수준 스레드에서는 스레드 전환이 발생할 때, 커널이 개입하지 않아 커널에서 사용자 영역으로 전환하지 않습니다. 그리고 커널은 스레드가 아닌 프로세스를 한 단위로 인식하고 프로세서를 할당합니다. 다수의 사용자 수준 스레드가 커널 수준 스레드 한개에 매핑되므로 다대일 스레드 매핑이라고도 합니다. 

##### 사용자 수준 스레드의 장점

커널에 독립적으로 스케줄링을 할 수 있어 모든 OS에 적용할 수 있습니다. 스케줄링이나 동기화를 하려고 커널을 호출하지 않으므로 커널 영역으로 전환하는 과정이 생략됩니다. 커널이 아닌 스레드 라이브러리에서 스레드 스케줄링을 제어하므로 응용 프로그램에 맞게 스케줄링할 수 있습니다.

##### 사용자 수준 스레드의 단점

프로세스 단위로 프로세서를 할당하여 다중 처리 환경을 갖춰도 스레드 단위로 다중 처리를 하지 못합니다. 동일한 프로세스의 스레드 한개가 대기 상태가 되면 이 중 어떤 쓰레드도 실행하지 못합니다. 커널이 한 프로세스에 속한 여러 쓰레드에 프로세서를 동시에 할당할 수 없어 다중 처리 시스템에서 규모를 확장하기가 어렵습니다. 스레드간 보호에 커널의 보호 방법을 사용할 수 없습니다. 스레드 라이브러리에서 스레 간 보호를 제공해야 프로세스 수준에서 보호가 가능합니다.

#### 커널 수준 스레드

커널 수준 스레드는 사용자 수준 스레드의 한계를 극복하는 방법으로 커널이 스레드와 관련된 모든 작업을 관리한다. 한 프로세스에서 다수의 스레드가 프로세서를 할당받아 병행으로 수행하고, 스레드 한 개가 대기 상태가 되면 동일한 프로세스에 .....


### 캐시의 지역성에 대해 설명해주세요.
### Thread-safe에 대해 설명해주세요. (hint: critical section)
### 뮤텍스와 세마포어의 차이를 설명해주세요
### 스케줄러가 무엇이고, 단기/중기/장기로 나누는 기준에 대해 설명해주세요.
### CPU 스케줄러인 FCFS, SJF, SRTF, Priority Scheduling, RR에 대해 간략히 설명해주세요.
### 동기와 비동기의 차이를 설명해주세요.
### 메모리 관리 전략에는 무엇이 있는지 간략히 설명해주세요.
### 가상 메모리에 대해 설명해주세요.
### 교착상태(데드락, Deadlock)의 개념과 조건을 설명해주세요.
### 외부 단편화와 내부 단편화에 대해 설명해주세요.
### Swapping에 대해 설명해주세요.


## Reference

지식을 공유해주신 분들께 감사드립니다.<br>
<br>
https://github.com/boostcamp-ai-tech-4/ai-tech-interview#%EF%B8%8F-operating-system<br>

https://github.com/JaeYeopHan/Interview_Question_for_Beginner/tree/master/OS#part-1-4-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C<br>

https://coding-start.tistory.com/199<br>